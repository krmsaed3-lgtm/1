<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>My Works</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<style>
    :root {
      --bg-main: #05060b;
      --bg-strip: #05070f;
      --bg-pill: #111827;
      --bg-pill-active: #263246;
      --text-primary: #ffffff;
      --text-secondary: #9ca3af;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background-color: var(--bg-main);
      color: var(--text-primary);
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
    }

    .app {
      min-height: 100vh;
      max-width: 480px;
      margin: 0 auto;
      padding: 12px 12px 24px;
    }

    .top-bar {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      padding-bottom: 10px;
    }

    .back-btn {
      position: absolute;
      left: 0;
      top: 0;
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background-color: #151824;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .back-btn img {
      transform: rotate(180deg);

      width: 18px;
      height: 18px;
      display: block;
    }

    .title {
      font-size: 16px;
      font-weight: 500;
    }

    .tabs-strip {
      margin-top: 12px;
      background-color: #05070f;
      border-radius: 18px;
      padding: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 4px;
    }

    .tab {
      flex: 1;
      padding: 8px 4px;
      border-radius: 14px;
      text-align: center;
      font-size: 11px;
      color: var(--text-secondary);
      line-height: 1.3;
      white-space: normal;
    }

    .tab.active {
      background-color: #263246;
      color: #e5f7ff;
    }

    .empty-state {
      margin-top: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
    }

    .works-wrap {
      margin-top: 26px;
      padding: 0 16px 16px;
    }

    .works-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .work-item {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 18px;
      padding: 14px 14px;
      backdrop-filter: blur(10px);
    }

    .work-top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .work-title {
      font-weight: 700;
      letter-spacing: 0.2px;
      font-size: 16px;
      line-height: 1.15;
    }

    .work-meta {
      margin-top: 6px;
      color: rgba(255, 255, 255, 0.65);
      font-size: 12px;
    }

    .work-pill {
      flex: 0 0 auto;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.12);
      color: rgba(255, 255, 255, 0.82);
    }

    .work-actions {
      margin-top: 12px;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .work-btn {
      cursor: pointer;
      border: none;
      outline: none;
      border-radius: 999px;
      padding: 10px 14px;
      background: rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.92);
      font-weight: 700;
      font-size: 13px;
    }

    .work-btn:hover {
      background: rgba(255, 255, 255, 0.12);
    }

    .work-btn.primary {
      background-image: linear-gradient(90deg, #18c1ff, #22e1a5);
      color: #071018;
    }

    .empty-state img {
      width: 150px;
      height: auto;
      opacity: 0.9;
    }

    .empty-text {
      font-size: 13px;
      color: var(--text-secondary);
    }

    @media (min-width: 481px) {
      body {
        display: flex;
        justify-content: center;
        background-color: #000;
      }
      .app {
        margin-top: 12px;
        border-radius: 20px;
        border: 1px solid #171924;
      }
    }
  </style>
</head>
<body>
<div class="app">
<header class="top-bar">
<button aria-label="Back" class="back-btn" type="button">
<img alt="Back" src="images/back-icon-D2ne3Npi.png"/>
</button>
<div class="title">My Works</div>
</header>
<main>
<section class="tabs-strip">
<div class="tab active">AI Tool Creation<br/>Record</div>
<div class="tab">AI Chat<br/>Conversation<br/>Record</div>
<div class="tab">AI Drawing Record</div>
</section>
<section id="worksWrap" class="works-wrap" style="display:none;">
  <div id="worksList" class="works-list"></div>
</section>

<section id="emptyState" class="empty-state">
  <img alt="No Data" src="images/data-null-C37GHZMZ.png"/>
  <div id="emptyText" class="empty-text">No More Data<br/>Available</div>
</section>
</main>
</div>
<script>
(function () {
  'use strict';

  var STORAGE_WORKS = 'jopai_ai_tools_works_v1';

  var backBtn = document.querySelector('.back-btn');
  var tabEls = Array.prototype.slice.call(document.querySelectorAll('.tab'));
  var worksWrap = document.getElementById('worksWrap');
  var worksList = document.getElementById('worksList');
  var emptyState = document.getElementById('emptyState');
  var emptyText = document.getElementById('emptyText');

  function safeJsonParse(str, fallback) {
    try {
      var v = JSON.parse(str);
      return v == null ? fallback : v;
    } catch (e) {
      return fallback;
    }
  }

  function getWorks() {
    var raw = localStorage.getItem(STORAGE_WORKS);
    var arr = safeJsonParse(raw, []);
    if (!Array.isArray(arr)) return [];
    return arr;
  }

  function formatTime(ts) {
    if (!ts) return '';
    var d = new Date(ts);
    if (isNaN(d.getTime())) return '';
    var yyyy = d.getFullYear();
    var mm = String(d.getMonth() + 1).padStart(2, '0');
    var dd = String(d.getDate()).padStart(2, '0');
    var hh = String(d.getHours()).padStart(2, '0');
    var mi = String(d.getMinutes()).padStart(2, '0');
    return yyyy + '-' + mm + '-' + dd + '  ' + hh + ':' + mi;
  }

  function clearNode(el) {
    while (el.firstChild) el.removeChild(el.firstChild);
  }

  function setEmpty(messageHtml) {
    worksWrap.style.display = 'none';
    emptyState.style.display = 'flex';
    if (messageHtml) emptyText.innerHTML = messageHtml;
  }

  function setListVisible() {
    emptyState.style.display = 'none';
    worksWrap.style.display = 'block';
  }

  function renderAiToolsWorks() {
    var works = getWorks();
    if (!works.length) {
      setEmpty('No saved tools yet<br/>Tap "Save ☆" on any tool to add it here.');
      return;
    }

    setListVisible();
    clearNode(worksList);

    works
      .slice()
      .sort(function (a, b) {
        return (b.ts || 0) - (a.ts || 0);
      })
      .forEach(function (w) {
        var item = document.createElement('div');
        item.className = 'work-item';

        var top = document.createElement('div');
        top.className = 'work-top';

        var name = document.createElement('div');
        name.className = 'work-name';
        name.textContent = w.name || 'Tool';

        var time = document.createElement('div');
        time.className = 'work-time';
        time.textContent = formatTime(w.ts);

        top.appendChild(name);
        top.appendChild(time);

        var meta = document.createElement('div');
        meta.className = 'work-meta';
        meta.textContent = (w.category ? w.category + ' • ' : '') + (w.action || 'Run');

        item.appendChild(top);
        item.appendChild(meta);

        worksList.appendChild(item);
      });
  }

  function renderPlaceholder(title) {
    setEmpty('No More Data<br/>Available');
  }

  function setActiveTab(idx) {
    tabEls.forEach(function (t, i) {
      if (i === idx) t.classList.add('active');
      else t.classList.remove('active');
    });

    // 0: AI Tools Works, 1: AI Chat, 2: AI Drawing
    if (idx === 0) renderAiToolsWorks();
    else renderPlaceholder(idx);
  }

  if (backBtn) {
    backBtn.addEventListener('click', function (e) {
      e.preventDefault();
      if (window.history && history.length > 1) {
        history.back();
      } else {
        window.location.href = 'index.html';
      }
    });
  }

  tabEls.forEach(function (t, idx) {
    t.addEventListener('click', function () {
      setActiveTab(idx);
    });
  });

  // Initial
  setActiveTab(0);
})();
</script><script src="common-nav.js"></script>
</body>
</html>
